{"id": "search_traces_error", "type": "esql", "description": "For a given time window, find traces in error and get overall latency of traces", "tags": ["rca"], "configuration": {"query": "FROM traces-*\n| WHERE @timestamp >= ?search_start AND @timestamp <= ?search_end\n| WHERE k8s.namespace.name == ?k8s_namespace OR k8s.namespace.name IS NULL\n| STATS \n  spans = COUNT(), \n  failed_spans = COUNT() WHERE event.outcome != \"success\",\n  latency_us = AVG(span.duration.us)\n  BY span.subtype, span.name, service.name, BUCKET(@timestamp, 1m)\n| EVAL failed_span_percent = (TO_DOUBLE(failed_spans) / TO_DOUBLE(spans)) * 100\n| LIMIT 1000", "params": {"search_start": {"type": "date", "description": "start of time window", "optional": false}, "search_end": {"type": "date", "description": "end of time window", "optional": false}, "k8s_namespace": {"type": "keyword", "description": "kubernetes namespace", "optional": true}}}, "readonly": false}