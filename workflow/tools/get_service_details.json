{"id": "get_service_details", "type": "esql", "description": "For a given service.name and service.environment, get the associated host.name and k8s.namespace.\n\nNotes:\n* Format input timestamps as `%Y-%m-%dT%H:%M:%SZ`\n* If the agent does not specifically reference a start of the time window, use the current time minus 1 hour\n* If the agent does not specifically reference an end of the time window, resolve that to the current time", "tags": ["rca"], "configuration": {"query": "FROM traces-*\n| WHERE @timestamp >= ?search_start AND @timestamp <= ?search_end\n| WHERE service.environment == ?service_environment OR service.environment IS NULL\n| WHERE service.name == ?service_name AND host.name IS NOT NULL\n| SORT @timestamp DESC\n| KEEP service.name, host.name, k8s.namespace.name\n| LIMIT 1", "params": {"search_start": {"type": "date", "description": "start of time window", "optional": false}, "search_end": {"type": "date", "description": "end of time window", "optional": false}, "service_name": {"type": "keyword", "description": "the name of the service", "optional": false}, "service_environment": {"type": "keyword", "description": "the service environment", "optional": true}}}, "readonly": false}