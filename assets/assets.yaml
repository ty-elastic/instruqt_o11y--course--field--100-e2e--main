apiVersion: batch/v1
kind: Job
metadata:
  name: assets-$JOB_ID
  group: assets
spec:
  template:
    spec:
      hostNetwork: true
      dnsPolicy: ClusterFirstWithHostNet
      containers:
        - image: $REPO/assets:$COURSE
          name: assets
          imagePullPolicy: Always
          command:
            - "python"
            - "/python-docker/app.py"
            - "--kibana_host"
            - "$elasticsearch_kibana_endpoint"
            - "--es_host"
            - "$elasticsearch_es_endpoint"    
            - "--es_apikey"
            - "$elasticsearch_api_key"    
            - "load"
      restartPolicy: Never
---

